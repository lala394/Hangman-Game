<!DOCTYPE html>

<html lang="en">

<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>Hangman Game</title>

    <link rel="stylesheet" href="assets/style-hangman.css">

</head>

<body>

     <div class="logo"><img src="assets/images/rockbanner2.jpg"></div>


    <div class="showcase-container">                                                                                                                                                                                                                                                                                   
        <div id="song-and-artist-name">Guess The Rock Band</div>

        <div id="game-content">

            <div class="picture-side"><img id="cover" src = "assets/images/titlepic1.png"></img></div>

            <div class="game-details">

                <p>Press any key to get started!</p>

                <p>Wins</p>

                <div id="winsScore"></div>

                <p>Current Word</p>

                <div id="secret_word"></div>

                <p>Number of guesses remaining</p>

                <div id="guesses_left"></div>

                <p>Letters Already Guessed</p>

                <div id="guessed_letters"></div>

            </div>

        </div>

    </div>

    <script type="text/javascript">

        class HangmanGame {

        constructor () {

          this.songs = [

          { title: "Monster by Skillet", image_source: "assets/images/skillet.jpg", band_name: "skillet" },
          { title: "The Kill by 30 Seconds to Mars", image_source: "assets/images/mars.jpg", band_name: "mars" },
          { title: "Bring Me to Life by Evanescence", image_source: "assets/images/evanescence.jpg", band_name: "evanescence" },
          { title: "Alone by Godsmack", image_source: "assets/images/godsmack.jpg", band_name: "godsmack" },
          { title: "Supermasive by Muse", image_source: "assets/images/muse.jpg", band_name: "muse" },
          { title: "Die Schlinge by Oomph", image_source: "assets/images/oomph.jpg", band_name: "oomph" },
          { title: "Sonne by Rammstein", image_source: "assets/images/rammstein.jpg", band_name: "rammstein" },
          { title: "Come as You Are by Nirvana", image_source: "assets/images/nirvana.jpg", band_name: "nirvana" },
          { title: "Back in Black by AC/DC", image_source: "assets/images/acdc.jpg", band_name: "acdc" },
          { title: "Show Must Go On by Queen", image_source: "assets/images/queen.jpg", band_name: "queen" },
        ]

          this.wins = 0
          this.left_guesses = 13

          this.guessed_letters = []

          this.current_word = ""
          this.resultWord = ""

          this.hidden_word = ""

          this.current_index = 0
          this.index_reg = []

          this.nextSong()

          this.showGameState()

        }

        showGameState () {

            document.querySelector("#winsScore").innerHTML = this.wins;

            document.querySelector("#guesses_left").innerHTML = this.left_guesses;

            document.querySelector("#guessed_letters").innerHTML = this.guessed_letters;

            document.querySelector("#secret_word").innerHTML = this.resultWord ;

        }

        resetGame () {
          this.nextSong()
          this.left_guesses = 13
          this.guessed_letters = []
        }

        nextSong () {   
            this.current_index = Math.floor(Math.random() * this.songs.length)
            this.current_word =this.songs[this.current_index].band_name;
            this.index_reg.push(this.current_index)
            
            console.log(this.current_word, this.current_index, this.index_reg);


            this.hidden_word = "-".repeat(this.current_word.length).split("");
            this.resultWord = this.hidden_word.join("")

            // this.current_song_index++;
        }
        
        incrementWins () {

            this.wins++;
        }

        updateMedia (){
            document.querySelector("#cover").innerHTML = "src=" + this.songs[this.current_index].image_source + "'>" ;
            document.querySelector("#song-and-artist-name").innerHTML = this.songs[this.current_index].title ;
        }

        decrementGuesses () {

            this.left_guesses--;
        }

        fillInLetters (letter) {

            let found = false;

            for(let i=0; i < this.current_word.length; i++) {

                if(letter === this.current_word[i]) {
                    found = true;
                    this.hidden_word[i] = letter

                }
                this.resultWord = this.hidden_word.join("")
            }

            if (!found) {

                this.guessed_letters.push(letter)
            }
        }

      }

      var game = new HangmanGame()


      document.onkeyup = function(pressed_button) {

          var userGuess = pressed_button.key

          game.fillInLetters(userGuess)

          if(game.resultWord == game.current_word){

             game.incrementWins()
             game.updateMedia()
             game.resetGame()
             
          }
        
          else {
          if(game.left_guesses > 1){
              game.decrementGuesses();
          }
          else{
            game.resetGame()
            alert ("You lose!")
          }
 
          }

        game.showGameState()
      } 

 

    </script>

</body>

</html>